{% extends 'product_app/base.html' %}
{% load multiplication_filters static %}
{% block title %}Checkout{% endblock %}

{% block content %}
<main class="checkout-page">

  <h1 class="checkout-title">Checkout</h1>

  <div class="checkout-content">

    <!-- LEFT COLUMN: Order Summary -->
    <aside class="order-summary-section">
      <div class="order-summary-card">
        <h2>Order Summary</h2>

        <ul class="summary-items">
          {% for item in cart_items %}
          <li class="summary-item">
            <div class="item-img-wrapper">
              <img src="{{ item.image_url }}" alt="{{ item.name }}" class="summary-item-img"/>
              <span class="summary-item-count">{{ item.quantity }}</span>
            </div>
            <div class="summary-item-details">
              <span class="summary-item-name">{{ item.name }}</span>
              {% if item.size %}
                <small class="summary-item-size">Size {{ item.size }}</small>
              {% endif %}
            </div>
            <div class="summary-item-price">Ksh {{ item.price|floatformat:2 }}</div>
          </li>
          {% endfor %}
        </ul>

        <div class="summary-totals">
          <div class="summary-row">
            <span>Subtotal</span>
            <span>Ksh {{ total_price|floatformat:2 }}</span>
          </div>
          <div class="summary-row">
            <span>Pickup in store <i class="fa fa-question-circle"></i></span>
            <span>FREE</span>
          </div>
          <div class="summary-total">
            <span>Total</span>
            <div class="total-amount">
              <span class="currency">KES</span>
              <span class="value">Ksh {{ total_price|floatformat:2 }}</span>
            </div>
          </div>
        </div>
      </div>
    </aside>

    <!-- RIGHT COLUMN: Payment & Delivery -->
    <section class="payment-section">

      <!-- M‑PESA PAYMENT CARD -->
      <div class="payment-card mpesa-section">
        <h2>Pay with MPESA</h2>
        <img src="{% static 'images/mpesa-logo.png' %}"
             alt="Safaricom M‑PESA" class="mpesa-icon"/>

        <ol class="mpesa-steps">
          <li>Go to the <strong>MPESA</strong> menu and select <strong>SEND MONEY</strong>.</li>
          <li><strong>Phone Number:</strong> 0757 228 583</li>
          <li><strong>Receiver’s Name:</strong> Igor Inteyiteka</li>
          <li><strong>Amount:</strong> Ksh {{ total_price|floatformat:2 }}</li>
          <li>Enter your MPESA PIN.</li>
          <li>Wait for the confirmation SMS.</li>
        </ol>

        <form method="post" action="">
          {% csrf_token %}
          <div class="form-group-inline">
            <label for="phone_number">Number Used to Pay</label>
            <input type="text" name="phone_number" id="phone_number"
                   placeholder="07XXXXXXXX" required/>
          </div>
          <div class="form-group-inline">
            <label for="mpesa_transaction_id">MPESA Transaction ID</label>
            <input type="text" name="mpesa_transaction_id"
                   id="mpesa_transaction_id" placeholder="NER07L88MX" required/>
          </div>
          <button type="submit" class="btn-submit">Submit</button>
        </form>
      </div>

      <!-- (Add other payment cards here: PayPal, Paystack…) -->

    </section>

  </div>
</main>
{% endblock %}
